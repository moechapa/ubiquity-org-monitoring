<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Email_Imp_Contacts_0</name>
        <label>Email Imp Contacts</label>
        <locationX>728</locationX>
        <locationY>2031</locationY>
        <actionName>Associated_Contact__c.Implementation_Complete_Auto_Email</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>aCon.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Associated_Contact__c.Implementation_Complete_Auto_Email</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Email_Sallus_Contacts</name>
        <label>Email Sallus Contacts</label>
        <locationX>922</locationX>
        <locationY>2336</locationY>
        <actionName>Associated_Contact__c.Implementation_Complete_Auto_Email_Sallus</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>sendAlertRichSallus</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>aCon.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Associated_Contact__c.Implementation_Complete_Auto_Email_Sallus</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Email_Simply_Contacts</name>
        <label>Email Simply Contacts</label>
        <locationX>719</locationX>
        <locationY>2177</locationY>
        <actionName>Associated_Contact__c.Implementation_Complete_Auto_Email_Simply</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Simply_Unbundled</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>aCon.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Associated_Contact__c.Implementation_Complete_Auto_Email_Simply</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Notify_Imp_Owner_and_Manager</name>
        <label>Notify Imp Owner and Manager</label>
        <locationX>448</locationX>
        <locationY>1744</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>ErrorEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddressesArray</name>
            <value>
                <elementReference>ErrorEmailRecipients</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>CurrentUser</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <stringValue>Missing data for {!$Record.Name}</stringValue>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Send_no_fund_email</name>
        <label>Send no fund email</label>
        <locationX>1290</locationX>
        <locationY>2278</locationY>
        <actionName>Associated_Contact__c.Implementation_Complete_no_funds_Auto_Email</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>aCon.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Associated_Contact__c.Implementation_Complete_no_funds_Auto_Email</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Send_TPA_Email</name>
        <label>Send TPA Email</label>
        <locationX>98</locationX>
        <locationY>2534</locationY>
        <actionName>Associated_Contact__c.Implementation_Complete_TPA_Form</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>onboardingTPA.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Associated_Contact__c.Implementation_Complete_TPA_Form</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>sendAlertRichSallus</name>
        <label>sendAlertRichSallus</label>
        <locationX>939</locationX>
        <locationY>2548</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <stringValue>Richard.Henderson@broadridge.com, Eric.Schmitt@broadridge.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>noreply@myubiquity.com</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <stringValue>New Sallus Account Created</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>richAtSallusBody</elementReference>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
    </actionCalls>
    <apiVersion>54.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Add_Recipients</name>
        <label>Add Recipients</label>
        <locationX>588</locationX>
        <locationY>1740</locationY>
        <assignmentItems>
            <assignToReference>ErrorEmailRecipients</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>$Record.Implementation__r.Owner:User.Email</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ErrorEmailRecipients</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>$Record.Implementation__r.Owner:User.Manager.Email</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>ErrorEmailRecipients</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>$User.Email</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Notify_Imp_Owner_and_Manager</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_Collection</name>
        <label>Add to Collection</label>
        <locationX>1501</locationX>
        <locationY>871</locationY>
        <assignmentItems>
            <assignToReference>completeTasks</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Close_Tasks</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Close_Tasks</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Complete_Tasks</name>
        <label>Complete Tasks</label>
        <locationX>1501</locationX>
        <locationY>751</locationY>
        <assignmentItems>
            <assignToReference>Close_Tasks.Actual_Completion_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>now</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Close_Tasks.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_Collection</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Client_Verification</name>
        <label>Client Verification</label>
        <locationX>1080</locationX>
        <locationY>2040</locationY>
        <defaultConnectorLabel>Client Missing</defaultConnectorLabel>
        <rules>
            <name>Completed_without_funding</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Complete_without_funding__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_no_fund_email</targetReference>
            </connector>
            <label>Completed without funding</label>
        </rules>
        <rules>
            <name>Client_Found</name>
            <conditionLogic>1 AND NOT 2 AND 3</conditionLogic>
            <conditions>
                <leftValueReference>aCon.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Service_Option__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Simply Retirement</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product_Type1__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>PEP</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Email_Imp_Contacts_0</targetReference>
            </connector>
            <label>Client Found</label>
        </rules>
        <rules>
            <name>Simply_Client_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>aCon.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Service_Option__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Simply Retirement</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Email_Simply_Contacts</targetReference>
            </connector>
            <label>Simply Client Found</label>
        </rules>
        <rules>
            <name>Sallus_Client_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>aCon.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Product_Type1__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>PEP</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Email_Sallus_Contacts</targetReference>
            </connector>
            <label>Sallus Client Found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Conversion_or_New_Plan</name>
        <label>Conversion or New Plan</label>
        <locationX>1124</locationX>
        <locationY>1248</locationY>
        <defaultConnector>
            <targetReference>Conversion_or_New_Plan_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not Eligible</defaultConnectorLabel>
        <rules>
            <name>Conversion</name>
            <conditionLogic>(1 AND 2) OR 3</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Implementation__r.Plan_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Conversion Plan</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Implementation__r.Conversion_Assets_Posted__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Implementation__r.Plan_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New Plan</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Close_Tasks_and_Imp_0</targetReference>
            </connector>
            <label>Conversion/New Plan</label>
        </rules>
    </decisions>
    <decisions>
        <name>Conversion_or_New_Plan_0</name>
        <label>Conversion or New Plan</label>
        <locationX>1278</locationX>
        <locationY>1680</locationY>
        <defaultConnectorLabel>Not Eligible</defaultConnectorLabel>
        <rules>
            <name>Conversion_0</name>
            <conditionLogic>(1 AND 2) OR 3</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Implementation__r.Plan_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Conversion Plan</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Implementation__r.Conversion_Assets_Settled__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Implementation__r.Plan_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New Plan</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Close_Imp_0_0_0</targetReference>
            </connector>
            <label>Conversion/New Plan</label>
        </rules>
    </decisions>
    <decisions>
        <name>Eligible_to_Complete</name>
        <label>Eligible to Complete</label>
        <locationX>1537</locationX>
        <locationY>233</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Get_Imp.Funding_Call_Complete__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Imp.Finch_Credential_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>active</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Imp.Census_Self_Service__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Open_Tasks</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Error_Type</name>
        <label>Error Type</label>
        <locationX>728</locationX>
        <locationY>1721</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Validation</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>$Flow.FaultMessage</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>FIELD_CUSTOM_VALIDATION_EXCEPTION:</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$User.Profile_ID__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>00e1G0000011hdP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$User.Profile_ID__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>00e00000006ohd0</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Recipients</targetReference>
            </connector>
            <label>Validation</label>
        </rules>
    </decisions>
    <decisions>
        <name>Null_Check</name>
        <label>Null Check</label>
        <locationX>1278</locationX>
        <locationY>1128</locationY>
        <defaultConnector>
            <targetReference>Conversion_or_New_Plan_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Tasks_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>completeTasks</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Conversion_or_New_Plan</targetReference>
            </connector>
            <label>Tasks Found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Onboarding_TPA_Found</name>
        <label>Onboarding TPA Found?</label>
        <locationX>299</locationX>
        <locationY>2433</locationY>
        <defaultConnectorLabel>Not Found</defaultConnectorLabel>
        <rules>
            <name>Yes_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>onboardingTPA.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Send_TPA_Email</targetReference>
            </connector>
            <label>Yes, Found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Payroll_Task</name>
        <label>Payroll Task</label>
        <locationX>1721</locationX>
        <locationY>631</locationY>
        <defaultConnector>
            <targetReference>Close_Tasks</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Close_Tasks_0</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Close_Tasks.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Upload 1st Payroll</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Close_Tasks.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Complete Implementation</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Complete_Tasks</targetReference>
            </connector>
            <label>Close Tasks</label>
        </rules>
        <rules>
            <name>Delete_Tasks</name>
            <conditionLogic>NOT 1 AND NOT 2</conditionLogic>
            <conditions>
                <leftValueReference>Close_Tasks.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Upload 1st Payroll</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Close_Tasks.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Complete Implementation</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Close_Tasks</targetReference>
            </connector>
            <label>Delete Tasks</label>
        </rules>
    </decisions>
    <decisions>
        <name>Simply_Unbundled</name>
        <label>Simply Unbundled?</label>
        <locationX>469</locationX>
        <locationY>2253</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Unbundled</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Imp.Service_Option__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Simply Retirement Unbundled</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Onboarding_TPA</targetReference>
            </connector>
            <label>Unbundled</label>
        </rules>
    </decisions>
    <decisions>
        <name>Task_Validation</name>
        <label>Task Validation</label>
        <locationX>1279</locationX>
        <locationY>508</locationY>
        <defaultConnector>
            <targetReference>Null_Check</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Open Tasks</defaultConnectorLabel>
        <rules>
            <name>Tasks_Found_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>openProjTasks</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Close_Tasks</targetReference>
            </connector>
            <label>Tasks Found</label>
        </rules>
    </decisions>
    <decisions>
        <description>Added path to account for plans that later fund after becoming active w/ no funding</description>
        <name>Validate_User</name>
        <label>Validate User</label>
        <locationX>1124</locationX>
        <locationY>176</locationY>
        <defaultConnector>
            <targetReference>Get_Imp</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Valid</defaultConnectorLabel>
        <rules>
            <name>Saver_Success_Catch</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$User.Profile_ID__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>00e1G0000011hjh</stringValue>
                </rightValue>
            </conditions>
            <label>Saver Success Catch</label>
        </rules>
        <rules>
            <name>Funding_after_the_fact</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Complete_without_funding__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Active Not Funded</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Most_Recent_Payroll_Submitted__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_plan_to_active</targetReference>
            </connector>
            <label>Funding after the fact</label>
        </rules>
    </decisions>
    <description>If Payroll Submitted, Close Imp.  If Imp fails to close from missing data, alert imp owner.

Added check so plans are eligible for completion with EITHER a funding call OR self service</description>
    <environments>Default</environments>
    <formulas>
        <name>FormattedError</name>
        <dataType>String</dataType>
        <expression>MID({!$Flow.FaultMessage},
FIND(&quot;FIELD_CUSTOM_VALIDATION_EXCEPTION:&quot;, {!$Flow.FaultMessage}),
FIND(&quot;You can look up ExceptionCode values&quot;,{!$Flow.FaultMessage})-FIND(&quot;FIELD_CUSTOM_VALIDATION_EXCEPTION:&quot;, {!$Flow.FaultMessage}))</expression>
    </formulas>
    <formulas>
        <name>now</name>
        <dataType>DateTime</dataType>
        <expression>NOW()</expression>
    </formulas>
    <formulas>
        <name>today</name>
        <dataType>Date</dataType>
        <expression>TODAY()</expression>
    </formulas>
    <interviewLabel>Plan | After Trigger | Close Imp {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Plan | After Trigger | Close Imp</label>
    <loops>
        <name>Close_Tasks</name>
        <label>Close Tasks</label>
        <locationX>1413</locationX>
        <locationY>511</locationY>
        <collectionReference>openProjTasks</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Payroll_Task</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Null_Check</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Client</name>
        <label>Get Client</label>
        <locationX>1080</locationX>
        <locationY>1920</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Client_Verification</targetReference>
        </connector>
        <filterLogic>1 AND (2 OR 3 OR 4)</filterLogic>
        <filters>
            <field>Implementation__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Implementation__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Contact_Role__c</field>
            <operator>Contains</operator>
            <value>
                <stringValue>Plan Sponsor</stringValue>
            </value>
        </filters>
        <filters>
            <field>Contact_Role__c</field>
            <operator>Contains</operator>
            <value>
                <stringValue>Trustee</stringValue>
            </value>
        </filters>
        <filters>
            <field>Contact_Role__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Authorized Buyer</stringValue>
            </value>
        </filters>
        <object>Associated_Contact__c</object>
        <outputAssignments>
            <assignToReference>aCon.Id</assignToReference>
            <field>Id</field>
        </outputAssignments>
        <sortField>CreatedDate</sortField>
        <sortOrder>Asc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>Get_Imp</name>
        <label>Get Imp</label>
        <locationX>1312</locationX>
        <locationY>203</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Eligible_to_Complete</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Plan__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Implementation__c</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Funding_Call_Complete__c</queriedFields>
        <queriedFields>Finch_Credential_Status__c</queriedFields>
        <queriedFields>Census_Self_Service__c</queriedFields>
        <queriedFields>Service_Option__c</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Onboarding_TPA</name>
        <label>Get Onboarding TPA</label>
        <locationX>307</locationX>
        <locationY>2254</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Onboarding_TPA_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Implementation__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Imp.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Contact_Role__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>TPA - Onboarding</stringValue>
            </value>
        </filters>
        <object>Associated_Contact__c</object>
        <outputReference>onboardingTPA</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Useable_Email__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Open_Tasks</name>
        <label>Get Open Tasks</label>
        <locationX>1271</locationX>
        <locationY>338</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Task_Validation</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Implementation__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Implementation__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Not Needed</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Declined</stringValue>
            </value>
        </filters>
        <object>Project_Task__c</object>
        <outputReference>openProjTasks</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Name</queriedFields>
    </recordLookups>
    <recordUpdates>
        <name>Close_Imp_0_0_0</name>
        <label>Close Imp</label>
        <locationX>1080</locationX>
        <locationY>1800</locationY>
        <connector>
            <targetReference>Get_Client</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Type</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Implementation__c</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Implementation_Completion_Date__c</field>
            <value>
                <elementReference>today</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Implementation_Stage__c</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Implementation_Status__c</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Implementation_Steps__c</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>X1st_Payroll_Date__c</field>
            <value>
                <elementReference>$Record.Most_Recent_Payroll_Submitted__c</elementReference>
            </value>
        </inputAssignments>
        <object>Implementation__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Close_Tasks_and_Imp_0</name>
        <label>Close Tasks and Imp</label>
        <locationX>992</locationX>
        <locationY>1367</locationY>
        <connector>
            <targetReference>Conversion_or_New_Plan_0</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Type</targetReference>
        </faultConnector>
        <inputReference>completeTasks</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_plan_to_active</name>
        <label>Update plan to active</label>
        <locationX>1056</locationX>
        <locationY>430</locationY>
        <inputAssignments>
            <field>Status__c</field>
            <value>
                <stringValue>Active</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>754</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>Validate_User</targetReference>
        </connector>
        <filterLogic>(((1 OR 7) AND 3) OR (8 AND 1)) AND 4 AND 5 AND 6 AND 2</filterLogic>
        <filters>
            <field>Most_Recent_Payroll_Submitted__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Implementation__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Implementation_Status__c</field>
            <operator>Contains</operator>
            <value>
                <stringValue>In Progress</stringValue>
            </value>
        </filters>
        <filters>
            <field>Most_Recent_Case_Sentiment_S_T__c</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Most_Recent_Case_Sentiment_Saver__c</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Sentiment_HM_Score__c</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Complete_without_funding__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Active Not Funded</stringValue>
            </value>
        </filters>
        <object>Plan__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>ErrorEmailBody</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Hello {!$Record.Implementation__r.Owner:User.FirstName},

The implementation for {!$Record.Name} attempted to close, but it was stopped by a validation error.  Please review the message below, and complete the appropriate fields on the implementation.

{!FormattedError}

Link to implementation: https://myubiquity.lightning.force.com/lightning/r/Implementation__c/{!$Record.Implementation__r.Implementation_ID_18_Char__c}/view

Thanks!

BI Team
____________</text>
    </textTemplates>
    <textTemplates>
        <name>richAtSallusBody</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>This notice informs you a new Sallus plan has been created - {!$Record.Name} / {!$Record.Custodian_Account_ID__c}.
Please reach out to your contact at Ubiquity with any questions.

Thank You,

Ubiquity</text>
    </textTemplates>
    <variables>
        <name>aCon</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Associated_Contact__c</objectType>
    </variables>
    <variables>
        <name>completeTasks</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Project_Task__c</objectType>
    </variables>
    <variables>
        <name>ErrorEmailRecipients</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>onboardingTPA</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Associated_Contact__c</objectType>
    </variables>
    <variables>
        <name>openProjTasks</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Project_Task__c</objectType>
    </variables>
</Flow>
