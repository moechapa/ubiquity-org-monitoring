<apex:page showHeader="false" lightningstylesheets="true">

    <!-- This script takes the endpoint URL parameter passed from the deployment page and makes it the action for the form -->
    <script type='text/javascript'>
    (function() {
        function handlePageLoad() {
            var endpointMatcher = new RegExp("[\\?\\&]endpoint=([^&#]*)");
            var domainMatcher = new RegExp("(https?:\\/\\/(.+?\\.)?(salesforce|salesforceliveagent)\\.com(\\/[A-Za-z0-9\\-\\._~:\\/\\?#\[\\]@!$&'\\(\\)\*\\+,;\\=]*)?)");
            var endpointAttr = endpointMatcher.exec(document.location.search)[1];

            // if the endpoint domain is valid
            if (domainMatcher.test(decodeURIComponent(endpointAttr))) {
                document.getElementById('prechatForm').setAttribute('action',
                decodeURIComponent(endpointAttr.replace("javascript:", "")));
            } else {
                // invalid endpoint domain, set the action to empty
                console.error("invalid domain: " + endpointAttr);
                document.getElementById('prechatForm').setAttribute('action', "");
            }
        }

        if (window.addEventListener) {
            window.addEventListener('load', handlePageLoad, false);
        } else {
            window.attachEvent('onload', handlePageLoad, false);
        }
    })();
    </script>



    <h1>Live Agent Pre-Chat Form</h1>

    <!-- Form that gathers information from the chat visitor and sets the values to Live Agent Custom Details used later in the example -->
    <form method='post' id='prechatForm'>

        <div class="field">
            <label for="company">Company:</label>
            <input require = "true" type='text' name='liveagent.prechat:ContactCompany' id='' />
            <input type="hidden" name="liveagent.prechat.save:ContactCompany" value="Pre_Chat_Company__c" /> 
        </div>

        <div class="field">
            <label for="firstName">First name:</label>  
            <input required = "true" type='text' name='liveagent.prechat:ContactFirstName' id='' />
            <input type="hidden" name="liveagent.prechat.save:ContactFirstName" value="Pre_Chat_First_Name__c" /> 
        </div>

        <div class="field">
            <label for="lastName">Last name:</label>
            <input required = "true" type='text' name='liveagent.prechat:ContactLastName' id='lastName' />
           <input type="hidden" name="liveagent.prechat.save:ContactLastName" value="Pre_Chat_Last_Name__c" /> 
        </div>

        <div class="field">
            <label for="email">Email:</label>
            <input required = "true" type='text' name='liveagent.prechat:ContactEmail' id='email' />
           <input type="hidden" name="liveagent.prechat.save:ContactEmail" value="Pre_Chat_Email_Address__c" /> 
        </div>

        <div class="field">
            <label for="group">I'm a(n):</label>
            <select name="liveagent.prechat:ContactGroup" id="group">
                <option>Employee</option>
                <option>Former Employee</option>
                <option>Plan Sponsor</option>
                <option>Plan Trustee</option>
                <option>Advisor</option>
                <option>Other</option>
            </select>
            <input type="hidden" name="liveagent.prechat.save:ContactGroup" value="Pre_Chat_Role__c" /> 
        </div>

        <div class="field">
            <label for="question">Question:</label>
            <input required = "true" type='text' name='liveagent.prechat:CaseSubject' id='question' />
            <input type="hidden" name="liveagent.prechat.save:CaseSubject" value="Pre_Chat_Question__c" /> 
        </div>
        
<input type="hidden" name="liveagent.prechat.save:PlanName" value="Paradigm_Plan_Name__c" /> 
         
       
        <!-- Hidden fields used to set additional custom details -->
        <input type="hidden" name="liveagent.prechat:CaseStatus" value="New" />
        <!-- This example assumes that "Chat" was added as picklist value to the Case Origin field -->
        <input type="hidden" name="liveagent.prechat:CaseOrigin" value="Chat" />
        <!-- This example will set the Case Record Type to a specific value for the record type configured on the org. Lookup the case record type's id on your org and set it here -->
        <input type="hidden" name="liveagent.prechat:CaseRecordType" value="012D00123456789" />

        <!-- Used to set the visitor's name for the agent in the Console -->
        <input type="hidden" name="liveagent.prechat.name" id="prechat_field_name" />
        <!-- map: Use the data from prechat form to map it to the Salesforce record's fields -->
        <input type="hidden" name="liveagent.prechat.findorcreate.map:Contact" value="FirstName,ContactFirstName;LastName,ContactLastName;Email,ContactEmail;Group,ContactGroup" />
        <input type="hidden" name="liveagent.prechat.findorcreate.map:Case" value="Subject,CaseSubject;Status,CaseStatus;Origin,CaseOrigin;RecordTypeId,CaseRecordType" />

        <!-- doFind, doCreate and isExactMatch example for a Contact:
        Find a contact whose Email exactly matches the value provided by the customer in the form
        If there's no match, then create a Contact record and set it's First Name, Last Name, and Email to the values provided by the customer -->
        <input type="hidden" name="liveagent.prechat.findorcreate.map.doFind:Contact" value="Email,true" />
        <input type="hidden" name="liveagent.prechat.findorcreate.map.isExactMatch:Contact" value="Email,true" />
        <input type="hidden" name="liveagent.prechat.findorcreate.map.doCreate:Contact" value="FirstName,true;LastName,true;Email,true;Group,true" />
        <!-- doCreate example for a Case: create a case to attach to the chat, set the Case Subject to the value provided by the customer and set the case's Status and Origin fields -->
        <input type="hidden" name="liveagent.prechat.findorcreate.map.doCreate:Case" value="Subject,true;Status,true;Origin,true;RecordTypeId,true" />
        <!-- linkToEntity: Set the record Contact record, found/created above, as the Contact on the Case that's created -->
        <input type="hidden" name="liveagent.prechat.findorcreate.linkToEntity:Contact" value="Case,ContactId" />
        <!-- showOnCreate: Open the Contact and Case records as sub-tabs to the chat for the agent in the Console -->
        <input type="hidden" name="liveagent.prechat.findorcreate.showOnCreate:Contact" value="true" />
        <input type="hidden" name="liveagent.prechat.findorcreate.showOnCreate:Case" value="true" />
        <!-- saveToTranscript: Associates the records found / created, i.e. Contact and Case, to the Live Chat Transcript record. -->
        <input type="hidden" name="liveagent.prechat.findorcreate.saveToTranscript:Contact" value="ContactId" />
        <input type="hidden" name="liveagent.prechat.findorcreate.saveToTranscript:Case" value="CaseId" />
        <!-- displayToAgent: Hides the case record type from the agent -->
        <input type="hidden" name="liveagent.prechat.findorcreate.displayToAgent:CaseRecordType" value="false" />
        <!-- searchKnowledge: Searches knowledge article based on the text, this assumes that Knowledge is setup -->
        <input type="hidden" name="liveagent.prechat.knowledgeSearch:CaseSubject" value="true" />

        <input type='submit' value='Chat Now' id='prechat_submit' onclick="setName()"/>

        <!-- Set the visitor's name for the agent in the Console to first and last name provided by the customer -->
        <script type="text/javascript">
        function setName() {
            document.getElementById("prechat_field_name").value = document.getElementById("firstName").value + " " + document.getElementById("lastName").value;
        }
        </script>

        <style type="text/css">
        body {
            padding: 20px;
        }
        form {
            margin: 24px 0 0 0;
        }
        div.field {
            margin: 0 0 12px 0;
        }
        div.field label {
            display: block;
        }
        div.field input[type=text] {
            width: 96%;
            height: auto;
            padding: 4px 8px;
            font-family: Roboto,sans-serif;
            font-size: 16px;
            line-height: 26px;
            font-weight: 400;
            color: #a7a6ae;
            background-color: #fff;
            border: 1px solid #e7e6ea;
            /*border-radius: 60px;*/
        }
        input[type=submit] {
            min-width: 160px;
            padding: 12px 24px;
            font-family: Nexa,sans-serif;
            font-size: 14px;
            line-height: 26px;
            font-weight: 600;
            text-align: center;
            color: #fff;
            background-color: #000;
            box-shadow: 2px 10px 30px 0 rgba(82,210,236,.25);
            border: none;
            /*border-radius: 60px;*/
            -webkit-transition: all 250ms ease;
            transition: all 250ms ease;
            outline: 0;
        }
        input[type=submit]:hover {
            text-decoration: none;
            color: #fff;
            background-color: #52d2ec;
            box-shadow: 2px 10px 30px 0 rgba(82,210,236,.5);
        }
        </style>
    </form>

</apex:page>